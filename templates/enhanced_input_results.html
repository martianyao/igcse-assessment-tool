<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Assessment Analysis - IGCSE Chemistry</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
        }

        .student-analysis-card {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            border-left: 6px solid var(--secondary-color);
        }

        .engagement-scale {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 8px;
            margin: 1rem 0;
        }

        .engagement-option {
            text-align: center;
        }

        .engagement-radio {
            display: none;
        }

        .engagement-label {
            display: block;
            background: #e9ecef;
            border: 3px solid #dee2e6;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            line-height: 44px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .engagement-label:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .engagement-1 .engagement-label {
            background: #e74c3c;
            color: white;
        }

        .engagement-2 .engagement-label {
            background: #ec7063;
            color: white;
        }

        .engagement-3 .engagement-label {
            background: #f39c12;
            color: white;
        }

        .engagement-4 .engagement-label {
            background: #f7dc6f;
            color: #333;
        }

        .engagement-5 .engagement-label {
            background: #f4d03f;
            color: #333;
        }

        .engagement-6 .engagement-label {
            background: #85c1e9;
            color: white;
        }

        .engagement-7 .engagement-label {
            background: #5dade2;
            color: white;
        }

        .engagement-8 .engagement-label {
            background: #58d68d;
            color: white;
        }

        .engagement-9 .engagement-label {
            background: #27ae60;
            color: white;
        }

        .engagement-radio:checked+.engagement-label {
            border-color: #2c3e50;
            box-shadow: 0 0 0 3px rgba(44, 62, 80, 0.3);
            transform: scale(1.2);
        }

        .attainment-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .attainment-component {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            border: 2px solid #e9ecef;
        }

        .attainment-scale {
            display: flex;
            justify-content: space-between;
            margin: 1rem 0;
        }

        .attainment-option {
            flex: 1;
            margin: 0 2px;
        }

        .attainment-option input[type="radio"] {
            display: none;
        }

        .attainment-option label {
            display: block;
            background: #e9ecef;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 8px 4px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .attainment-option input[type="radio"]:checked+label {
            background: var(--secondary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .question-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
            gap: 8px;
            margin: 1rem 0;
        }

        .question-number {
            background: #e9ecef;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 8px;
            text-align: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .question-number:hover {
            transform: scale(1.05);
        }

        .question-number.correct {
            background: var(--success-color);
            color: white;
            border-color: #229954;
        }

        .question-number.incorrect {
            background: var(--danger-color);
            color: white;
            border-color: #c0392b;
        }

        .ai-insight-panel {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        @media (max-width: 768px) {
            .engagement-scale {
                grid-template-columns: repeat(5, 1fr);
                gap: 6px;
            }

            .engagement-label {
                width: 40px;
                height: 40px;
                line-height: 34px;
                font-size: 0.9rem;
            }

            .attainment-section {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark"
        style="background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/">
                <i class="fas fa-flask me-2"></i>
                IGCSE Chemistry Assessment
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/dashboard">
                    <i class="fas fa-arrow-left me-1"></i>
                    Dashboard
                </a>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <!-- Assessment Header -->
        <div class="alert alert-primary" role="alert">
            <h2><i class="fas fa-chart-line me-3"></i>Comprehensive Performance Analysis</h2>
            <h4>Two-Part Assessment System: Engagement Rate (1-9) + Attainment Analysis</h4>
            <p class="mb-0">Input comprehensive assessment data for AI-powered insights and predictions</p>
        </div>

        <!-- Student Analysis Cards -->
        <div class="student-analysis-card" id="student-1">
            <div class="row">
                <!-- Student Info -->
                <div class="col-md-3">
                    <h4 class="mb-3">
                        <i class="fas fa-user-graduate me-2 text-primary"></i>
                        Alice Johnson
                    </h4>
                    <p class="text-muted mb-2"><strong>ID:</strong> ST001</p>
                    <p class="text-muted mb-3"><strong>Current Level:</strong> High</p>

                    <!-- Quick Assessment Score -->
                    <div class="bg-light p-3 rounded">
                        <h6><i class="fas fa-clipboard-check me-2"></i>Assessment Score</h6>
                        <div class="question-grid" id="questions-1">
                            <div class="question-number" onclick="toggleQuestion(1, 1)" id="q-1-1">1</div>
                            <div class="question-number" onclick="toggleQuestion(1, 2)" id="q-1-2">2</div>
                            <div class="question-number" onclick="toggleQuestion(1, 3)" id="q-1-3">3</div>
                            <div class="question-number" onclick="toggleQuestion(1, 4)" id="q-1-4">4</div>
                            <div class="question-number" onclick="toggleQuestion(1, 5)" id="q-1-5">5</div>
                            <div class="question-number" onclick="toggleQuestion(1, 6)" id="q-1-6">6</div>
                            <div class="question-number" onclick="toggleQuestion(1, 7)" id="q-1-7">7</div>
                            <div class="question-number" onclick="toggleQuestion(1, 8)" id="q-1-8">8</div>
                            <div class="question-number" onclick="toggleQuestion(1, 9)" id="q-1-9">9</div>
                            <div class="question-number" onclick="toggleQuestion(1, 10)" id="q-1-10">10</div>
                        </div>
                        <div class="mt-2 text-center">
                            <strong>Score: <span id="score-1">0/10</span></strong>
                        </div>
                    </div>
                </div>

                <!-- Engagement Analysis -->
                <div class="col-md-4">
                    <div class="bg-light p-3 rounded">
                        <h5 class="mb-3">
                            <i class="fas fa-heart me-2 text-danger"></i>
                            Engagement Rate (1-9)
                        </h5>

                        <div class="engagement-scale">
                            <div class="engagement-option engagement-1">
                                <input type="radio" name="engagement-1" id="eng-1-1" value="1" class="engagement-radio"
                                    onchange="updateEngagement(1, 1)">
                                <label for="eng-1-1" class="engagement-label">1</label>
                            </div>
                            <div class="engagement-option engagement-2">
                                <input type="radio" name="engagement-1" id="eng-2-1" value="2" class="engagement-radio"
                                    onchange="updateEngagement(1, 2)">
                                <label for="eng-2-1" class="engagement-label">2</label>
                            </div>
                            <div class="engagement-option engagement-3">
                                <input type="radio" name="engagement-1" id="eng-3-1" value="3" class="engagement-radio"
                                    onchange="updateEngagement(1, 3)">
                                <label for="eng-3-1" class="engagement-label">3</label>
                            </div>
                            <div class="engagement-option engagement-4">
                                <input type="radio" name="engagement-1" id="eng-4-1" value="4" class="engagement-radio"
                                    onchange="updateEngagement(1, 4)">
                                <label for="eng-4-1" class="engagement-label">4</label>
                            </div>
                            <div class="engagement-option engagement-5">
                                <input type="radio" name="engagement-1" id="eng-5-1" value="5" class="engagement-radio"
                                    onchange="updateEngagement(1, 5)">
                                <label for="eng-5-1" class="engagement-label">5</label>
                            </div>
                            <div class="engagement-option engagement-6">
                                <input type="radio" name="engagement-1" id="eng-6-1" value="6" class="engagement-radio"
                                    onchange="updateEngagement(1, 6)">
                                <label for="eng-6-1" class="engagement-label">6</label>
                            </div>
                            <div class="engagement-option engagement-7">
                                <input type="radio" name="engagement-1" id="eng-7-1" value="7" class="engagement-radio"
                                    onchange="updateEngagement(1, 7)">
                                <label for="eng-7-1" class="engagement-label">7</label>
                            </div>
                            <div class="engagement-option engagement-8">
                                <input type="radio" name="engagement-1" id="eng-8-1" value="8" class="engagement-radio"
                                    onchange="updateEngagement(1, 8)">
                                <label for="eng-8-1" class="engagement-label">8</label>
                            </div>
                            <div class="engagement-option engagement-9">
                                <input type="radio" name="engagement-1" id="eng-9-1" value="9" class="engagement-radio"
                                    onchange="updateEngagement(1, 9)">
                                <label for="eng-9-1" class="engagement-label">9</label>
                            </div>
                        </div>

                        <small class="text-muted">1-3: Disengaged, 4-6: Moderate, 7-9: Highly Engaged</small>

                        <!-- Engagement Evidence -->
                        <div class="mt-3">
                            <label class="form-label fw-bold">
                                <i class="fas fa-eye me-1"></i>
                                Observed Evidence:
                            </label>
                            <div class="row">
                                <div class="col-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="asking-1">
                                        <label class="form-check-label">Question Asking</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="answering-1">
                                        <label class="form-check-label">Question Answering</label>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="focus-1">
                                        <label class="form-check-label">Sustained Focus</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="activity-1">
                                        <label class="form-check-label">Activity Engagement</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Attainment Analysis -->
                <div class="col-md-5">
                    <div class="bg-light p-3 rounded">
                        <h5 class="mb-3">
                            <i class="fas fa-trophy me-2 text-warning"></i>
                            Attainment Analysis
                        </h5>

                        <div class="attainment-section">
                            <!-- Preparation Outcome -->
                            <div class="attainment-component">
                                <h6 class="mb-3">
                                    <i class="fas fa-book-open me-2"></i>
                                    Preparation Outcome
                                </h6>
                                <div class="attainment-scale">
                                    <div class="attainment-option">
                                        <input type="radio" name="prep-1" id="prep-emerging-1" value="emerging">
                                        <label for="prep-emerging-1">Emerging</label>
                                    </div>
                                    <div class="attainment-option">
                                        <input type="radio" name="prep-1" id="prep-developing-1" value="developing">
                                        <label for="prep-developing-1">Developing</label>
                                    </div>
                                    <div class="attainment-option">
                                        <input type="radio" name="prep-1" id="prep-secure-1" value="secure">
                                        <label for="prep-secure-1">Secure</label>
                                    </div>
                                    <div class="attainment-option">
                                        <input type="radio" name="prep-1" id="prep-mastery-1" value="mastery">
                                        <label for="prep-mastery-1">Mastery</label>
                                    </div>
                                </div>
                                <small class="text-muted">Based on homework, revision, and pre-class preparation</small>
                            </div>

                            <!-- In-Class Practice -->
                            <div class="attainment-component">
                                <h6 class="mb-3">
                                    <i class="fas fa-chalkboard me-2"></i>
                                    In-Class Practice
                                </h6>
                                <div class="attainment-scale">
                                    <div class="attainment-option">
                                        <input type="radio" name="practice-1" id="practice-emerging-1" value="emerging">
                                        <label for="practice-emerging-1">Emerging</label>
                                    </div>
                                    <div class="attainment-option">
                                        <input type="radio" name="practice-1" id="practice-developing-1"
                                            value="developing">
                                        <label for="practice-developing-1">Developing</label>
                                    </div>
                                    <div class="attainment-option">
                                        <input type="radio" name="practice-1" id="practice-secure-1" value="secure">
                                        <label for="practice-secure-1">Secure</label>
                                    </div>
                                    <div class="attainment-option">
                                        <input type="radio" name="practice-1" id="practice-mastery-1" value="mastery">
                                        <label for="practice-mastery-1">Mastery</label>
                                    </div>
                                </div>
                                <small class="text-muted">Based on class activities, discussions, and practical
                                    work</small>
                            </div>
                        </div>

                        <!-- Additional Notes -->
                        <div class="mt-3">
                            <label class="form-label fw-bold">
                                <i class="fas fa-sticky-note me-1"></i>
                                Additional Notes:
                            </label>
                            <textarea class="form-control" id="notes-1" rows="2"
                                placeholder="Specific observations, areas of strength/concern..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Insight Preview -->
            <div class="ai-insight-panel" id="ai-panel-1" style="display: none;">
                <h6>
                    <i class="fas fa-robot me-2"></i>
                    AI Analysis Preview
                </h6>
                <div id="ai-content-1">
                    Complete the assessment to see AI-powered insights...
                </div>
            </div>
        </div>

        <!-- Generate AI Analysis Button -->
        <div class="text-center my-5">
            <button class="btn btn-primary btn-lg me-3" onclick="submitAnalysis()">
                <i class="fas fa-brain me-2"></i>
                Generate AI Performance Report
            </button>
            <button class="btn btn-outline-secondary" onclick="saveProgress()">
                <i class="fas fa-save me-2"></i>
                Save Progress
            </button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <script>
        // Data structure for comprehensive analysis
        let studentAnalysisData = {
            1: {
                name: "Alice Johnson",
                testAnswers: {},
                testScore: 0,
                engagementRate: null,
                engagementEvidence: {
                    questioning: false,
                    answering: false,
                    focus: false,
                    activity: false
                },
                attainment: {
                    preparation: null,
                    inClass: null
                },
                notes: "",
                completed: false
            }
        };

        // Question management
        function toggleQuestion(studentId, questionNum) {
            const questionEl = document.getElementById(`q-${studentId}-${questionNum}`);
            const currentState = questionEl.classList.contains('correct') ? 'correct' :
                questionEl.classList.contains('incorrect') ? 'incorrect' : 'unanswered';

            // Cycle through states
            let newState;
            switch (currentState) {
                case 'unanswered':
                    newState = 'correct';
                    studentAnalysisData[studentId].testAnswers[questionNum] = true;
                    break;
                case 'correct':
                    newState = 'incorrect';
                    studentAnalysisData[studentId].testAnswers[questionNum] = false;
                    break;
                case 'incorrect':
                    newState = 'unanswered';
                    delete studentAnalysisData[studentId].testAnswers[questionNum];
                    break;
            }

            // Update visual state
            questionEl.className = 'question-number ' + (newState !== 'unanswered' ? newState : '');

            // Update score
            updateTestScore(studentId);
        }

        function updateTestScore(studentId) {
            const answers = studentAnalysisData[studentId].testAnswers;
            const score = Object.values(answers).filter(answer => answer === true).length;

            studentAnalysisData[studentId].testScore = score;
            document.getElementById(`score-${studentId}`).textContent = `${score}/10`;
            checkCompletion(studentId);
        }

        // Engagement management
        function updateEngagement(studentId, level) {
            studentAnalysisData[studentId].engagementRate = level;
            checkCompletion(studentId);
        }

        function checkCompletion(studentId) {
            const data = studentAnalysisData[studentId];
            const hasAnswers = Object.keys(data.testAnswers).length === 10;
            const hasEngagement = data.engagementRate !== null;
            const hasAttainment = data.attainment.preparation && data.attainment.inClass;

            if (hasAnswers && hasEngagement && hasAttainment) {
                generateAIPreview(studentId);
            }
        }

        function generateAIPreview(studentId) {
            const data = studentAnalysisData[studentId];
            const panel = document.getElementById(`ai-panel-${studentId}`);
            const content = document.getElementById(`ai-content-${studentId}`);

            // Calculate performance metrics
            const scorePercentage = Math.round((data.testScore / 10) * 100);
            const engagementLevel = data.engagementRate;

            // Generate AI-style insight
            let prediction = "";
            if (engagementLevel >= 7 && scorePercentage >= 80) {
                prediction = "High achiever with excellent engagement. Predicted IGCSE grade: A-A*";
            } else if (engagementLevel >= 5 && scorePercentage >= 60) {
                prediction = "Solid performance with good engagement. Predicted IGCSE grade: B-C";
            } else {
                prediction = "Requires additional support. Consider intervention strategies.";
            }

            content.innerHTML = `
                <div class="row">
                    <div class="col-md-6">
                        <strong>Performance:</strong> ${scorePercentage}% (${data.testScore}/10)<br>
                        <strong>Engagement Level:</strong> ${engagementLevel}/9<br>
                        <strong>Attainment:</strong> Prep: ${data.attainment.preparation || 'N/A'}, Practice: ${data.attainment.inClass || 'N/A'}
                    </div>
                    <div class="col-md-6">
                        <strong>AI Prediction:</strong><br>
                        <small>${prediction}</small>
                    </div>
                </div>
            `;

            panel.style.display = 'block';
        }

        function submitAnalysis() {
            const completedStudents = Object.values(studentAnalysisData).filter(s => s.completed);

            alert(`ðŸ§  AI Analysis Ready!

ðŸ“Š Students analyzed: ${Object.keys(studentAnalysisData).length}
ðŸŽ¯ Comprehensive performance analysis complete
ðŸ“ˆ Engagement and attainment correlation calculated

This demonstrates the comprehensive assessment system:
âœ… 1-9 Engagement Scale with evidence tracking
âœ… Dual attainment analysis (preparation + in-class)
âœ… AI-powered performance correlation
âœ… IGCSE grade predictions
âœ… Personalized intervention recommendations

Ready for full implementation!`);
        }

        function saveProgress() {
            alert('Assessment progress saved successfully!');
        }

        // Initialize event listeners
        document.addEventListener('DOMContentLoaded', function () {
            // Add event listeners for attainment radios
            document.querySelectorAll('input[name="prep-1"]').forEach(radio => {
                radio.addEventListener('change', function () {
                    studentAnalysisData[1].attainment.preparation = this.value;
                    checkCompletion(1);
                });
            });

            document.querySelectorAll('input[name="practice-1"]').forEach(radio => {
                radio.addEventListener('change', function () {
                    studentAnalysisData[1].attainment.inClass = this.value;
                    checkCompletion(1);
                });
            });

            // Evidence checkboxes
            ['asking', 'answering', 'focus', 'activity'].forEach(type => {
                document.getElementById(`${type}-1`).addEventListener('change', function () {
                    const mapping = {
                        'asking': 'questioning',
                        'answering': 'answering',
                        'focus': 'focus',
                        'activity': 'activity'
                    };
                    studentAnalysisData[1].engagementEvidence[mapping[type]] = this.checked;
                });
            });

            // Notes
            document.getElementById('notes-1').addEventListener('input', function () {
                studentAnalysisData[1].notes = this.value;
            });
        });
    </script>
</body>

</html>